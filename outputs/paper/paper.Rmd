---
title: "The increasing trend in shooting occurrences in Toronto"
author: 
  - Varun Vijay
thanks: "Code and data are available at: https://github.com/Varun1005473462/starter_folder-main."
date: "`r format(Sys.time(), '%d %B %Y')`"
abstract: "Statistics about shooting occurrences are a very important statistic to consider in Toronto as gun violence is a very serious problem in the modern world. I obtained and analyed yearly data from 2014 to 2019 about shooting occurences that were reported in Toronto from the city on a geographic basis. I found a mostly increasing trend in shooting occurences for Toronto from 2014 to 2019 and a close correlation between year and number of shooting occurences in the year. My findings have serious implications for the crime rate and the effectiveness of gun control in Toronto "
output:
  bookdown::pdf_document2
toc: FALSE
bibliography: references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include=FALSE}
options(tinytex.verbose = TRUE)
```

# Introduction

The problem of gun violence is a very serious issue in the modern world. Guns are capable of dealing large losses to life in very short periods of time. In order to deal with this problem, proper gun control laws are require and must be implemented in an effective manner to reduce the number of shooting occurrences in Toronto. Statistics and data about shooting occurrences can be used to measure how effective the current gun control laws are in reducing the amount of shooting occurrences. The data could also be used as an indicator of police effectiveness and the crime rate. 

Second paragraph is about what was done and what was found.
In this paper, the shooting occurrences dataset was analysed using bar plots, scatterplots and various summary statistics about the dataset such as the correlation between year and number of shooting occurences in said year

Third paragraph about implications

The remainder of this paper is: Section \@ref(data) explains data. Section \@ref(results) explains results, etc..... 



# Data

The dataset used for this paper was the Shooting Occurrences dataset provided in the Police Annual Statistical report.

Extract of dataset (Table \@ref(tab:dataextract))

```{r dataextract, echo=FALSE}
library(tidyverse)
library(knitr)
shooting_occurences<-
  read_csv(here::here("inputs/data/shooting_occurences.csv"))
shooting_occurences %>% 
  select(OccurredYear,GeoDivision,Category, Count_) %>%
  slice(1:10) %>%
  kable(
    caption = "Table 1: First ten rows of a dataset that shows shooting Occurences in Toronto",
    col.names=c('Occured Year','Geo Division','Category','Count'),
    digits=1,
    booktabs=TRUE,
    linesep="")  ## Creating an extract of the dataset
```

Paragraph or two more about the Table \@ref(tab:dataextract)

Our dataset is of shooting occurrences in Toronto

I was interested in the relationship between the current year and the number of shooting occurrences that took place in said year because it was a measure of how effective gun control policies are in Toronto from year to year. I was also interested in how the geographical divisions included in the dataset for shooting occurrences for each year.

Figure \@ref(fig:bar plot 1) shows the relationship between year and shooting occurrences. 


```{r bar plot 1, echo=FALSE}
shooting_barplot <- 
  shooting_occurences %>% 
  mutate(Year = 
           case_when(OccurredYear==2014 ~ "2014",
                     OccurredYear==2015 ~ "2015",
                     OccurredYear==2016 ~ "2016",
                     OccurredYear==2017 ~ "2017",
                     OccurredYear==2018 ~ "2018",
                     OccurredYear==2019 ~ "2019",
                     ),
         Year = factor(Year,
                            levels = c("2014",
                                       "2015",
                                       "2016",
                                       "2017",
                                       "2018",
                                       "2019"
                                       )
                            )
         )
shooting_barplot %>%  
  ggplot(mapping = aes(x=Year,y=Count_)) +
  geom_bar(stat='identity')+
  labs(title='Figure 1',
       x="Year",
       y="Shooting occurrences") ## using stat=identity to have include
## and y variable for the bar plot
```

From Figure \@ref(fig:bar plot 1), we can see that there appears to be a mostly increasing trend in shooting occurrences over the years. It decreases from 2016 to 2017 but then increases again from 2017 to 2018 and maintains the trend. Using the dataset, this increasing trend could be interpreted as a rise in gun violence over the course of 5 years in Toronto and the relaxation or decreased effectiveness of gun control laws.

Figure \@ref(fig:bar plot 2) shows how the geographical division of the shooting occurrences for each year.

```{r bar plot 2, echo=FALSE}
shooting_barplot %>%  
  ggplot(mapping = aes(Year,Count_, fill=GeoDivision)) +
  geom_bar(stat='identity',position='dodge')+
  labs(title='Figure 2',
       x="Year",
       y="Shooting count")
```



Talk more about it.



Condensing the data to find the maximum shooting occurences for each year
```{r, echo=FALSE}
shooting_occurences_2014<-shooting_occurences %>%
  filter(OccurredYear==2014)
count_2014<-sum(shooting_occurences_2014$Count_)
shooting_occurences_2015<-shooting_occurences %>%
  filter(OccurredYear==2015)
count_2015<-sum(shooting_occurences_2015$Count_)
shooting_occurences_2016<-shooting_occurences %>%
  filter(OccurredYear==2016)
count_2016<-sum(shooting_occurences_2016$Count_)
shooting_occurences_2017<-shooting_occurences %>%
  filter(OccurredYear==2017)
count_2017<-sum(shooting_occurences_2017$Count_)
shooting_occurences_2018<-shooting_occurences %>%
  filter(OccurredYear==2018)
count_2018<-sum(shooting_occurences_2018$Count_)
shooting_occurences_2019<-shooting_occurences %>%
  filter(OccurredYear==2019)
count_2019<-sum(shooting_occurences_2019$Count_)
Year<-c(2014,2015,2016,2017,2018,2019)
Shooting_count<-c(count_2014,count_2015,count_2016,count_2017,count_2018,count_2019)
shooting_occurences_year<-data.frame(Year,Shooting_count)
shooting_occurences_year
```


```{r, echo =FALSE}
library(modelsummary)
shooting_occurences_year %>%
  datasummary_skim()
```

```{r, echo =FALSE}
shooting_occurences_year %>%
  ggplot(mapping = aes(x = Year, y = Shooting_count)) +
  geom_point()+
  labs(title="Relationship between year and shooting occurences in that year")
```


```{r, echo=FALSE}
shooting_occurences_year %>%
  datasummary_correlation()
```


Talk way more about it. 


# Results

# Discussion

## First discussion point

If my paper were 10 pages, then should be be at least 2.5 pages. The discussion is a chance to show off what you know and what you learnt from all this. 

## Second discussion point

## Third discussion point

## Weaknesses and next steps

Weaknesses and next steps should also be included.

\newpage

\appendix

# Appendix {-}


# Additional details


\newpage


# References


